<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Wizard · SunlightHNC.jl</title><meta name="title" content="Wizard · SunlightHNC.jl"/><meta property="og:title" content="Wizard · SunlightHNC.jl"/><meta property="twitter:title" content="Wizard · SunlightHNC.jl"/><meta name="description" content="Documentation for SunlightHNC.jl."/><meta property="og:description" content="Documentation for SunlightHNC.jl."/><meta property="twitter:description" content="Documentation for SunlightHNC.jl."/><meta property="og:url" content="https://hsugawa8651.github.io/SunlightHNC.jl/wizard/"/><meta property="twitter:url" content="https://hsugawa8651.github.io/SunlightHNC.jl/wizard/"/><link rel="canonical" href="https://hsugawa8651.github.io/SunlightHNC.jl/wizard/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SunlightHNC.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Manual</span><ul><li class="is-active"><a class="tocitem" href>Wizard</a><ul class="internal"><li><a class="tocitem" href="#Core"><span>Core</span></a></li><li><a class="tocitem" href="#Potentials"><span>Potentials</span></a></li><li><a class="tocitem" href="#charge_types"><span>Constants for <code>charge_type</code></span></a></li><li><a class="tocitem" href="#Solvers"><span>Solvers</span></a></li><li><a class="tocitem" href="#return_codes"><span>Constants for <code>return_code</code></span></a></li><li><a class="tocitem" href="#closure_types"><span>Constants for <code>closure_type</code></span></a></li><li><a class="tocitem" href="#Solver-utilities"><span>Solver utilities</span></a></li><li><a class="tocitem" href="#Statistical-Mechanics"><span>Statistical Mechanics</span></a></li><li><a class="tocitem" href="#Reports"><span>Reports</span></a></li><li><a class="tocitem" href="#Utilities"><span>Utilities</span></a></li></ul></li><li><a class="tocitem" href="../models/">Models</a></li><li><a class="tocitem" href="../plots/">Plots</a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Wizard</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Wizard</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/hsugawa8651/SunlightHNC.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/main/docs/src/wizard.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="Core"><a class="docs-heading-anchor" href="#Core">Core</a><a id="Core-1"></a><a class="docs-heading-anchor-permalink" href="#Core" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.Wizard" href="#SunlightHNC.Wizard"><code>SunlightHNC.Wizard</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> mutable struct Wizard</code></pre><p>holds lots of HNC data.</p><p><strong>Important fields for input</strong></p><ul><li>Also refer to immutable arguments in <a href="#SunlightHNC.Wizard-Tuple{}"><code>Wizard()</code></a></li></ul><p><strong>Immutable fields set by <a href="#SunlightHNC.Wizard-Tuple{}"><code>Wizard()</code></a></strong></p><ul><li><code>ncomp</code>: number of chemical components</li><li><code>nfnc</code> : number of functions = <code>ncomp (ncomp + 1) / 2</code></li><li><code>r</code> : real space grid</li><li><code>k</code> : reciprocal space grid (computed)</li><li><code>deltak</code> : reciprocal space grid spacing (computed)</li></ul><p><strong>Mutable fields, which may be modified before invoking a solver.</strong></p><ul><li><code>rho</code> : density array</li><li><code>z</code>: valence array</li><li><code>arep</code> :repulsion amplitude array</li><li><code>dd</code>: hard core diameter array</li><li><code>diam</code> : hard core diameter array, pairwise</li><li><code>sigma</code> : used both for the long-range Coulomb smearing length for the soft potentials, and for hard core diameter for RPM models.</li><li><code>sigmap</code> : +- long-range Coulomb smearing length (URPM)</li><li><code>kappa</code> : +- long-range Coulomb smoothing parameter (RPM)</li><li><code>rgroot</code> : linear charge smearing range (Groot)</li><li><code>lbda</code> : Slater charge smearing range (exact)</li><li><code>beta</code> : Slater charge smearing range (approx)</li><li><code>alpha</code>: Picard method, fraction of new solution</li><li><code>rc</code> : short-range DPD repulsion range</li><li><code>lb</code> : long-range Coulomb coupling length</li></ul><p><strong>Computed and allocated fields, calculated by solvers.</strong></p><ul><li><code>c</code> : direct correlation functions (dcfs)</li><li><code>e</code> : indirect correlation functions (icfs)</li><li><code>ck</code> : transform of dcfs</li><li><code>ek</code> : transform of icfs</li><li><code>sk</code> : partial structure factors</li><li><code>h0</code> : reference total correlation functions</li><li><code>hr</code> : current total correlation functions</li><li><code>hc</code> : current contact values</li><li><code>ushort</code> : short range potential in real space</li><li><code>dushort</code> : derivative of <code>ushort</code></li><li><code>ulong</code> : long range potential in real space</li><li><code>dulong</code> : derivative of <code>ulong</code></li><li><code>ulongk</code> : long range potential in reciprocal space</li><li><code>expnegus</code> : <code>exp(-ushort)</code> (includes hard cores)</li><li><code>u0</code> : r = 0 of long range potential (diagonal)</li><li><code>muex</code>: chemical potential array</li><li><code>tp</code> : mean field pressure contribution</li><li><code>tu</code> : mean field energy contribution</li><li><code>tl</code> : mean field long range potential</li></ul><p><strong>Important fields for output</strong></p><ul><li><code>ERROR</code> : difference between current and previous solutions</li><li><code>return_code</code> : return (error) code, any of <a href="#return_codes"><code>return_code</code></a></li><li><code>closure_type</code> : any of <a href="#closure_types"><code>closure_type</code></a></li><li><code>model_type</code> : which potential was (last) chosen</li><li><code>nsteps</code> : actual number of steps taken</li></ul><p><strong>Working fields for FFT</strong></p><ul><li><code>planFFT</code></li><li><code>fftw</code></li></ul><p><strong>Some fields are calculated by following methods</strong></p><ul><li><a href="#SunlightHNC.make_pair_functions!"><code>make_pair_functions!</code></a> </li><li><a href="#SunlightHNC.make_structure_factors!"><code>make_structure_factors!</code></a> </li><li><a href="#SunlightHNC.make_thermodynamics!"><code>make_thermodynamics!</code></a> </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L92-L153">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.Wizard-Tuple{}" href="#SunlightHNC.Wizard-Tuple{}"><code>SunlightHNC.Wizard</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Wizard(; kwargs...)</code></pre><p>Construct <a href="#SunlightHNC.Wizard"><code>Wizard</code></a> object.</p><p><strong>Immutable arguments, each used as the struct&#39;s field as it is</strong></p><ul><li><code>ncomp::Int64=1</code> &gt;= 1: number of chemical components</li><li><code>ng::Int64=2^8</code> &gt; 0: grid size</li><li><code>nps::Int64=6</code> &gt;= 2: number of previous states used in Ng method</li><li><code>npic::Int64=6</code> &gt;= 2: number of Picard steps</li><li><code>deltar::Float64=1e-2</code> &gt; 0 : real space grid spacing</li></ul><p><strong>Mutable arguments, used to control solver</strong></p><ul><li><code>tol::Float64=1e-12</code> &gt; 0 : Error tolerance for claiming convergence</li><li><code>maxsteps::Int64=100</code> : max number of steps to take for convergence</li><li><code>verbose::Bool=false</code> : Print solver diagnostics</li><li><code>silent::Bool=false</code> : Prevent printing warning/error messages</li><li><code>suppress_msgs::Bool=false</code> : In case of severe numerical instability</li><li><code>auto_fns:Bool=true</code> : Calculate stuff at end</li><li><code>cold_start</code> :  Force a cold start</li><li><code>start_type</code> : how to initialise in a cold start</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L242-L261">source</a></section></article><h2 id="Potentials"><a class="docs-heading-anchor" href="#Potentials">Potentials</a><a id="Potentials-1"></a><a class="docs-heading-anchor-permalink" href="#Potentials" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.dpd_potential!" href="#SunlightHNC.dpd_potential!"><code>SunlightHNC.dpd_potential!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dpd_potential!(w::Wizard, charge_type=DPD_GAUSSIAN_CHARGES)</code></pre><p>Build the potential arrays.</p><p><strong>Arguments</strong></p><ul><li><code>charge_type</code> : Use <a href="#charge_types">the defined integer constants</a> for these.<ul><li><code>DPD_GAUSSIAN_CHARGES=1</code>, Gaussian (default)</li><li><code>DPD_BESSEL_CHARGES=2</code>, Bessel</li><li><code>DPD_LINEAR_CHARGES=3</code>, Groot (linear)</li><li><code>DPD_SLATER_APPROX_CHARGES=4</code>, Slater (approx)</li><li><code>DPD_SLATER_EXACT_CHARGES=5</code>, Slater (exact) </li></ul></li></ul><p><strong>Referred fields in Wizard object</strong></p><p>A factor <code>beta</code> = 1/kT is implicit in the following definitions.</p><p><strong>Fields referred by all <code>charge_type</code></strong></p><ul><li><code>arep[:,:]</code> </li><li><code>z</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L539-L558">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.rpm_potential!" href="#SunlightHNC.rpm_potential!"><code>SunlightHNC.rpm_potential!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rpm_potential!(w::Wizard, use_ushort=false)</code></pre><p>Build the potential arrays for the softened RPM (charged hard spheres).</p><p>Using <code>kappa &lt; 0</code> implies the pure RPM case (<code>kappa</code> -&gt; infinity). </p><p>The case <code>ncomp = 3</code> corresponds to the RPM in the presence of a neutral hard sphere solvent.</p><p><strong>Arguments</strong></p><ul><li><code>use_ushort::Bool=false</code>: whether ushort is used or not.</li></ul><p><strong>Referred fields for input</strong></p><ul><li><code>diam</code></li><li><code>sigma</code></li><li><code>lb</code></li><li><code>kappa</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L850-L868">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.urpm_potential!" href="#SunlightHNC.urpm_potential!"><code>SunlightHNC.urpm_potential!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">urpm_potential!(w::Wizard, use_ushort=false)</code></pre><p>Build the potential arrays for the softened URPM (Gaussian charges), This expects <code>ncomp = 2</code>, and will set <code>z[1] = 1</code>, <code>z[2] = -1</code>.  </p><p><strong>Arguments</strong></p><ul><li><code>use_ushort::Bool=false</code>: whether ushort is used or not.</li></ul><p><strong>Referred fields for input</strong></p><ul><li><code>sigma</code></li><li><code>sigmap</code></li><li><code>lb</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L746-L759">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.hs_potential!" href="#SunlightHNC.hs_potential!"><code>SunlightHNC.hs_potential!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hs_potential!(w::Wizard)</code></pre><p>Build the potential arrays for hard spheres with diameter <code>sigma</code>. This works for arbitrary numbers of components.</p><p><strong>Referred fields for input</strong></p><ul><li><code>diam</code></li><li><code>sigma</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L993-L1002">source</a></section></article><h2 id="charge_types"><a class="docs-heading-anchor" href="#charge_types">Constants for <code>charge_type</code></a><a id="charge_types-1"></a><a class="docs-heading-anchor-permalink" href="#charge_types" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.NO_MODEL_TYPE" href="#SunlightHNC.NO_MODEL_TYPE"><code>SunlightHNC.NO_MODEL_TYPE</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>NO_MODEL_TYPE - constant for <code>charge_type</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.DPD_GAUSSIAN_CHARGES" href="#SunlightHNC.DPD_GAUSSIAN_CHARGES"><code>SunlightHNC.DPD_GAUSSIAN_CHARGES</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>DPD_GAUSSIAN_CHARGES - constant for <code>charge_type</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.DPD_BESSEL_CHARGES" href="#SunlightHNC.DPD_BESSEL_CHARGES"><code>SunlightHNC.DPD_BESSEL_CHARGES</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>DPD_BESSEL_CHARGES - constant for <code>charge_type</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.DPD_LINEAR_CHARGES" href="#SunlightHNC.DPD_LINEAR_CHARGES"><code>SunlightHNC.DPD_LINEAR_CHARGES</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>DPD_LINEAR_CHARGES - constant for <code>charge_type</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.DPD_SLATER_APPROX_CHARGES" href="#SunlightHNC.DPD_SLATER_APPROX_CHARGES"><code>SunlightHNC.DPD_SLATER_APPROX_CHARGES</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>DPD_SLATER<em>APPROX\</em>CHARGES - constant for <code>charge_type</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.DPD_SLATER_EXACT_CHARGES" href="#SunlightHNC.DPD_SLATER_EXACT_CHARGES"><code>SunlightHNC.DPD_SLATER_EXACT_CHARGES</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>DPD_SLATER<em>EXACT\</em>CHARGES - constant for <code>charge_type</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.URPM_WITHOUT_USHORT" href="#SunlightHNC.URPM_WITHOUT_USHORT"><code>SunlightHNC.URPM_WITHOUT_USHORT</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>URPM_WITHOUT_USHORT - constant for <code>charge_type</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.URPM_WITH_USHORT" href="#SunlightHNC.URPM_WITH_USHORT"><code>SunlightHNC.URPM_WITH_USHORT</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>URPM_WITH_USHORT - constant for <code>charge_type</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.RPM_WITHOUT_USHORT" href="#SunlightHNC.RPM_WITHOUT_USHORT"><code>SunlightHNC.RPM_WITHOUT_USHORT</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>RPM_WITHOUT_USHORT - constant for <code>charge_type</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.RPM_WITH_USHORT" href="#SunlightHNC.RPM_WITH_USHORT"><code>SunlightHNC.RPM_WITH_USHORT</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>RPM_WITH_USHORT - constant for <code>charge_type</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.HARD_SPHERES" href="#SunlightHNC.HARD_SPHERES"><code>SunlightHNC.HARD_SPHERES</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>HARD_SPHERES - constant for <code>charge_type</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L70">source</a></section></article><h2 id="Solvers"><a class="docs-heading-anchor" href="#Solvers">Solvers</a><a id="Solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Solvers" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.oz_solve!" href="#SunlightHNC.oz_solve!"><code>SunlightHNC.oz_solve!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">oz_solve!(w::Wizard)</code></pre><p>Solve the Ornstein-Zernicke equation  to determine <code>e = h - c</code>, given <code>c</code>.  We re-partition the long range part of the potential so that the routine actually calculates <code>c&#39; = c + Ulong</code> and <code>e&#39; = e - Ulong</code>.   This is because the Fourier transform of <code>Ulong</code> can be computed in closed form.   Note <code>h = e + c = e&#39; + c&#39;</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L1040-L1048">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.oz_solve2!" href="#SunlightHNC.oz_solve2!"><code>SunlightHNC.oz_solve2!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">oz_solve2!(w::Wizard)</code></pre><p>Solve an alternate version of the Ornstein-Zernicke equation  to determine <code>c</code> and <code>e</code> from the reference <code>h0</code>.   In practice as always we actually  calculate <code>c&#39; = c + Ulong</code> and <code>e&#39; = e - Ulong</code>. Note <code>h = e + c = e&#39; + c&#39;</code>.   The result is saved to position 1 in the history trajectory.   Note that the offset <code>ulongk</code> in.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L1160-L1170">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.hnc_ng!" href="#SunlightHNC.hnc_ng!"><code>SunlightHNC.hnc_ng!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hnc_ng!(w::Wizard)</code></pre><p>This method implements the Ng method K-C Ng, J. Chem. Phys. v61, 2680 (1974), doi:<a href="https://doi.org/10.1063/1.1682399">10.1063/1.1682399</a> as an accelerated solver for the HNC closure.  As we iterate we move forward in the history trajectory, cyclically.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L1307-L1313">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.hnc_picard!" href="#SunlightHNC.hnc_picard!"><code>SunlightHNC.hnc_picard!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hnc_picard!(w::Wizard)</code></pre><p>This method implements the HNC closure expressed  as <code>c = exp( -beta v + e) - e - 1</code>  where <code>e = h - c</code> is the indirect correlation function,  <code>c</code> is the direct correlation function from the Ornstein-Zernicke relation, <code>h = g - 1</code>, and <code>g</code> is the pair distribution function.   One can show this is equivalent to <code>g = exp(-v + h - c)</code> in Hansen + McDonald.   As above, the routine actually works  with <code>c&#39; = c + Ulong</code> and <code>e&#39; = e - Ulong</code>  where <code>Ulong</code> is the long-range part of the potential for which the Fourier transform is simple.  This means that <code>v</code> in the above expression is the short-range part of the potential only.  As we iterate we move forward in the history trajectory, cyclically.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L1276-L1292">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.hnc_solve!" href="#SunlightHNC.hnc_solve!"><code>SunlightHNC.hnc_solve!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hnc_solve!(w::Wizard)</code></pre><p>Basic driver routine for solving HNC: take a number of Picard iterations to pump-prime the Ng method.  Stop when error is less than tolerance, or when exceed maximum number of iterations.  The flag <code>cold_start</code> indicates whether the direct correlation function should be re-initialised.  </p><p>The initial guess to the direct correlation function is either </p><ul><li><code>0</code> (zero) (<code>start_type = 1</code>), or </li><li><code>c = - Ushort</code> (<code>start_type = 2</code>), or </li><li><code>c = e^(-Ushort)-1</code> (<code>start_type = 3</code>).   </li></ul><p>Any of these should do in principle,  but the initial convergence may be different. Note from above that <code>c</code> is actually defined <code>c&#39; = c + Ulong</code>,  ie with the long-range part of the potential added.  </p><p>Note that we always start from position <code>1</code> in the history trajectory, and the history trajectory is pump-primed by Picard steps before attempting the Ng accelerator.   At the end, the final solution is copied back to position <code>1</code> in the history trajectory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L1382-L1405">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.msa_ng!" href="#SunlightHNC.msa_ng!"><code>SunlightHNC.msa_ng!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">msa_ng!(w::Wizard)</code></pre><p>This method implements the Ng method K-C Ng, J. Chem. Phys. v61, 2680 (1974), doi: <a href="https://doi.org/10.1063/1.1682399">10.1063/1.1682399</a> as an accelerated solver for the MSA closure (cf HNC above).  As we iterate we move forward in the history trajectory, cyclically.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L1517-L1522">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.msa_picard!" href="#SunlightHNC.msa_picard!"><code>SunlightHNC.msa_picard!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">msa_picard!(w::Wizard)</code></pre><p>This method implements the MSA closure expressed as <code>c&#39; = - e&#39; - 1</code> within the hard core, in similar terms to the HNC closure.   Outwith the hard core, <code>c&#39; = - beta  v&#39;</code> is left untouched,  presuming it is set correctly in the MSA initialisation step.  As we iterate we move forward in the history trajectory, cyclically.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L1494-L1503">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.msa_solve!" href="#SunlightHNC.msa_solve!"><code>SunlightHNC.msa_solve!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">msa_solve!(w::Wizard)</code></pre><p>Basic driver routine for solving MSA: take a number of Picard iterations to pump-prime the Ng method.  Stop when error is less than tolerance, or when exceed maximum number of iterations.  The flag <code>cold_start</code> indicates whether the direct correlation function should be re-initialised.  </p><p>For a cold start, the initial guess to the direct correlation function inside the hard core is <code>c&#39; = -1</code>.</p><p>Irrespective of this,  we need to make sure <code>c&#39;</code> is correctly initialised outwith the hard core.  </p><p>Note that we always start from position <code>1</code> in the history trajectory, and the history trajectory is pump-primed by Picard steps before attempting the Ng accelerator. At the end, the final solution is copied back to position <code>1</code> in the history trajectory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L1598-L1617">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.rpa_solve!" href="#SunlightHNC.rpa_solve!"><code>SunlightHNC.rpa_solve!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rpa_solve!(w::Wizard)</code></pre><p>Given the HNC machinery, the implementation of the RPA is almost completely trivial and corresponds to one iteration through the Ornstein-Zernike solver given the choice c = - Ushort.  We save the result to position 1 in the history trajectory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L1686-L1693">source</a></section></article><h2 id="return_codes"><a class="docs-heading-anchor" href="#return_codes">Constants for <code>return_code</code></a><a id="return_codes-1"></a><a class="docs-heading-anchor-permalink" href="#return_codes" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.NO_ERROR" href="#SunlightHNC.NO_ERROR"><code>SunlightHNC.NO_ERROR</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>NO_ERROR – constant for <code>return_code</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.CONVERGENCE_ERROR" href="#SunlightHNC.CONVERGENCE_ERROR"><code>SunlightHNC.CONVERGENCE_ERROR</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>CONVERGENCE_ERROR - constant for <code>return_code</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L76">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.AXEQB_ERROR" href="#SunlightHNC.AXEQB_ERROR"><code>SunlightHNC.AXEQB_ERROR</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>AXEQB_ERROR - constant for <code>return_code</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.DSYSV_ERROR" href="#SunlightHNC.DSYSV_ERROR"><code>SunlightHNC.DSYSV_ERROR</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>DSYSV_ERROR - constant for <code>return_code</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.DGEEV_ERROR" href="#SunlightHNC.DGEEV_ERROR"><code>SunlightHNC.DGEEV_ERROR</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>DGEEV_ERROR - constant for <code>return_code</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.MISMATCH_ERROR" href="#SunlightHNC.MISMATCH_ERROR"><code>SunlightHNC.MISMATCH_ERROR</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>MISMATCH_ERROR - constant for <code>return_code</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L84">source</a></section></article><h2 id="closure_types"><a class="docs-heading-anchor" href="#closure_types">Constants for <code>closure_type</code></a><a id="closure_types-1"></a><a class="docs-heading-anchor-permalink" href="#closure_types" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.NO_CLOSURE" href="#SunlightHNC.NO_CLOSURE"><code>SunlightHNC.NO_CLOSURE</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>NO_CLOSURE - constant for <code>closure_type</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.HNC_CLOSURE" href="#SunlightHNC.HNC_CLOSURE"><code>SunlightHNC.HNC_CLOSURE</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>HNC_CLOSURE - constant for <code>closure_type</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.RPA_CLOSURE" href="#SunlightHNC.RPA_CLOSURE"><code>SunlightHNC.RPA_CLOSURE</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>RPA_CLOSURE - constant for <code>closure_type</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.MSA_CLOSURE" href="#SunlightHNC.MSA_CLOSURE"><code>SunlightHNC.MSA_CLOSURE</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>MSA_CLOSURE - constant for <code>closure_type</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.EXP_CLOSURE" href="#SunlightHNC.EXP_CLOSURE"><code>SunlightHNC.EXP_CLOSURE</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>EXP_CLOSURE - constant for <code>closure_type</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L46">source</a></section></article><h2 id="Solver-utilities"><a class="docs-heading-anchor" href="#Solver-utilities">Solver utilities</a><a id="Solver-utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Solver-utilities" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.conv_test!" href="#SunlightHNC.conv_test!"><code>SunlightHNC.conv_test!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">conv_test!(w::Wizard)</code></pre><p>Calculate the difference between the direct correlation functions for the current and previous iteration, used as a convergence test; return answer in variable &#39;error&#39;.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L1477-L1483">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.hnc_kspace_integrals!" href="#SunlightHNC.hnc_kspace_integrals!"><code>SunlightHNC.hnc_kspace_integrals!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hnc_kspace_integrals!(w::Wizard)</code></pre><p>Calculate the reciprocal space contributions to the HNC free energy.  </p><p>Note that <code>c = c&#39; - Ulong</code>, and <code>ck</code> is available after a call to OZ solver.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L2056-L2062">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.exp_refine!" href="#SunlightHNC.exp_refine!"><code>SunlightHNC.exp_refine!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">exp_refine!(w::Wizard)</code></pre><p>The EXP approximation refines the current RPA/MSA solution by using the current solution (<code>h = c + e</code>) and a reference solution (<code>h0</code>) to send <code>h0 --&gt; (1 + h0) exp(h - h0) - 1</code>.  A round trip through the alternate version of the Ornstein-Zernike relation re-calculates the direct and indirect correlation functions.  We assume the current solution is in position 1 in the history trajectory.  The reference state is reset to <code>h0 = 0</code> after a call to this function, for safety!</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L1724-L1734">source</a></section></article><h2 id="Statistical-Mechanics"><a class="docs-heading-anchor" href="#Statistical-Mechanics">Statistical Mechanics</a><a id="Statistical-Mechanics-1"></a><a class="docs-heading-anchor-permalink" href="#Statistical-Mechanics" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.make_pair_functions!" href="#SunlightHNC.make_pair_functions!"><code>SunlightHNC.make_pair_functions!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">make_pair_functions!(w::Wizard)</code></pre><p>Construct the total correlation functions out of the direct correlation functions. Note that the above routines actually works with <code>c&#39; = c + Ulong</code> and <code>e&#39; = e - Ulong</code>  where <code>Ulong</code> is the long-range part of the potential,  but <code>h = g - 1 = e + c = e&#39; + c&#39;</code>.   The pair correlation functions are <code>g = 1 + h</code> - the addition of <code>1</code> is left for the user to implement.   We assume the <code>c</code> and <code>e</code> functions are those in the position <code>1</code> in the history trajectory.</p><p><strong>Fields calculated by this method</strong></p><ul><li><code>hc</code> : current contact values</li><li><code>hr</code> : current total correlation functions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L1781-L1797">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.make_structure_factors!" href="#SunlightHNC.make_structure_factors!"><code>SunlightHNC.make_structure_factors!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">make_structure_factors!(w::Wizard)</code></pre><p>Construct the structure factors out of the transform of the total correlation function.   Note that <code>ck</code> and <code>ek</code> are available after a call to the OZ solver.</p><p><strong>Fields calculated by this method</strong></p><ul><li><code>hk</code> : fourier transformed pair functions</li><li><code>sk</code> : fourier transformed partial structure factors</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L1756-L1765">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.make_thermodynamics!" href="#SunlightHNC.make_thermodynamics!"><code>SunlightHNC.make_thermodynamics!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">make_thermodynamics!(w::Wizard)</code></pre><p>Calculate various thermodynamics properties by spatial integration (as contrasted to thermodynamic integration).  We use the trapezium rule, taking account where necessary the end-point values (see intro), <code>h_0 = 2 h_1 - h_2</code> at <code>r = 0</code> (<code>i = 1</code>),  and <code>h_n = 0</code> at <code>r = L</code> (<code>i = ng</code>).   Also we have <code>r = i * deltar</code> for <code>i = 1</code> to <code>ng-1</code>.   Note that the above routines actually  work with <code>c&#39; = c + Ulong</code> and  <code>e&#39; = e - Ulong</code> where <code>Ulong</code> is the long-range part of the potential,  so we have <code>h = g - 1 = e + c = e&#39; + c&#39;</code>.   See also Vrbka et al, J. Chem. Phys. 131, 154109 (2009), doi:<a href="https://doi.org/10.1063/1.3248218">10.1063/1.3248218</a>. We assume the <code>c</code> and <code>e</code> functions are those in the position <code>1</code> in the history trajectory.</p><p>The mean-field thermodynamic expressions can often be obtained analytically from the potential. In this routine they are calculated from species pair contributions, which are themselves calculated in the potential routines (which do not have access to the densities).</p><p><strong>Fields calculated by this method</strong></p><ul><li><code>cf_mf</code> : Compressibility factor: mean field contribution</li><li><code>cf_xc</code> : Compressibility factor: contact contribution</li><li><code>cf_gc</code> : Compressibility factor: correlation contribution</li><li><code>pex</code> :  Excess pressure, virial route</li><li><code>press</code> : Pressure, virial route</li><li><code>comp</code> : Compressibility: total</li><li><code>comp_xc</code> : Compressibility: correlation contribution</li><li><code>uex</code> : Internal energy density</li><li><code>uex_mf</code> : Internal energy density: mean field contribution</li><li><code>uex_xc</code> : Internal energy density: correlation contribution</li><li><code>aex_rl</code> : HNC excess free energy density, real space (long)</li><li><code>aex_rs</code> : HNC excess free energy density, real space (short)</li><li><code>aex_kd</code> : HNC excess free energy density, k-space log(det)</li><li><code>aex_kl</code> : HNC excess free energy density, k-space tr (long)</li><li><code>aex_ks</code> : HNC excess free energy density, k-space tr (short)</li><li><code>aex</code> : HNC total free energy density</li><li><code>deficit</code> : HNC excess free energy deficit (see docs)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L1829-L1868">source</a></section></article><h2 id="Reports"><a class="docs-heading-anchor" href="#Reports">Reports</a><a id="Reports-1"></a><a class="docs-heading-anchor-permalink" href="#Reports" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.save_reference" href="#SunlightHNC.save_reference"><code>SunlightHNC.save_reference</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_reference(w::Wizard)</code></pre><p>Save the reference state, assuming the <code>c</code> and <code>e</code> functions  are those in the position 1 in the history trajectory.   The corresponding <code>c</code> and <code>e</code> functions can be restored by a call to <code>oz_solve2</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L1713-L1719">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.write_params" href="#SunlightHNC.write_params"><code>SunlightHNC.write_params</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_params(w::Wizard)</code></pre><p>Write out parameters for system and potentials.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L444-L448">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.write_thermodynamics" href="#SunlightHNC.write_thermodynamics"><code>SunlightHNC.write_thermodynamics</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_thermodynamics(w::Wizard)</code></pre><p>Write out parameters for thermodynamics.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L2140-L2144">source</a></section></article><h2 id="Utilities"><a class="docs-heading-anchor" href="#Utilities">Utilities</a><a id="Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.upperTriangularIndices" href="#SunlightHNC.upperTriangularIndices"><code>SunlightHNC.upperTriangularIndices</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">upperTriangularIndices(n::Int)</code></pre><p>Traverse every element <code>[i,j]</code> of the upper triangular matrix</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L364-L368">source</a></section><section><div><pre><code class="language-julia hljs">upperTriangularIndices(w::Wizard)</code></pre><p>Equivalent to <code>upperTriangularIndices(w.ncomp)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L381-L385">source</a></section><section><div><pre><code class="language-julia hljs">upperTriangularIndices(n::Int, nlimit::Int)</code></pre><p>Traverse every element <code>[i,j]</code> of the upper triangular matrix. Restrict <code>i</code> and <code>j</code> &lt;= <code>nlimit</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L389-L394">source</a></section><section><div><pre><code class="language-julia hljs">upperTriangularIndices(w::Wizard, nlimit::Int)</code></pre><p>Equivalent to <code>upperTriangularIndices(w.ncomp, nlimit)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L410-L414">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SunlightHNC.diagonalUpperTriangularIndices" href="#SunlightHNC.diagonalUpperTriangularIndices"><code>SunlightHNC.diagonalUpperTriangularIndices</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">diagonalUpperTriangularIndices(n::Int)</code></pre><p>Traverse diagonal element [i,i] of the upper triangular matrix</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L418-L422">source</a></section><section><div><pre><code class="language-julia hljs">diagonalUpperTriangularIndices(w::Wizard)</code></pre><p>Equivalen to <code>diagonalUpperTriangularIndices(w.ncomp)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hsugawa8651/SunlightHNC.jl/blob/5de48d3c601b0e2b64676e91e57bfe10154f81cb/src/wizard.jl#L437-L441">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../models/">Models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Tuesday 24 June 2025 05:35">Tuesday 24 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
